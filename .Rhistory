mod2
fcast2 <- forecast.ets(mod2, h=5)
fcast2
setwd("D:/Allan/DropBox/Dmin")
cc_ll <- function(df){
res <- c(0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
#browser()
r <- sum(f[f$confidence.U.== ll[i],21])
l <- ll[i]
res <- rbind(res,c(l,r))
}
return(res)
}
f <- read.csv('as_arima_dow_res.csv',stringsAsFactors=T)
setwd("D:/Allan/DropBox/AS_Arima")
setwd("D:/Allan/DropBox/AS_Arima")
f <- read.csv('as_arima_dow_res.csv',stringsAsFactors=T)
cc_ll(f)
f <- read.csv('as_arima_dow_res.csv',stringsAsFactors=F)
cc_ll(f)
f <- read.csv('as_arima_dow_res.csv',stringsAsFactors=T)
cc_ll(f)
f <- read.csv('as_arima_dow_res.csv',stringsAsFactors=T)
f$pl <- ifelse(f1$pred=='U',f1$Close-f1$Open,f1$Open-f1$Close)
rr <- cc_ll(f) ; rr
f$pl <- ifelse(f1$pred=='U',f1$Close-f1$Open,f1$Open-f1$Close)
f1 <- read.csv('as_arima_dow_res.csv',stringsAsFactors=T)
f$pl <- ifelse(f1$pred=='U',f1$Close-f1$Open,f1$Open-f1$Close)
f <- read.csv('as_arima_dow_res.csv',stringsAsFactors=T)
f$pl <- ifelse(f$pred=='U',f$Close-f$Open,f$Open-f$Close)
rr <- cc_ll(f) ; rr
cc_ll <- function(df){
res <- c(0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
#browser()
r <- round(sum(f[f$confidence.U.== ll[i],21]),2)
l <- round(ll[i],2)
res <- rbind(res,c(l,r))
}
return(res)
}
f <- read.csv('as_arima_dow_res.csv',stringsAsFactors=T)
f$pl <- ifelse(f$pred=='U',f$Close-f$Open,f$Open-f$Close)
rr <- cc_ll(f) ; rr
f <- read.csv('as_arima_dow_res.csv',stringsAsFactors=T)
f$pl <- ifelse(f$pred=='U',f$Close-f$Open,f$Open-f$Close)
rr <- cc_ll(f) ; rr
cc_ll <- function(df){
res <- c(0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
#browser()
r <- round(sum(f[f$confidence.U.== ll[i],21]),2)
l <- round(as.numeric(ll[i]),2)
res <- rbind(res,c(l,r))
}
return(res)
}
f <- read.csv('as_arima_dow_res.csv',stringsAsFactors=T)
f$pl <- ifelse(f$pred=='U',f$Close-f$Open,f$Open-f$Close)
rr <- cc_ll(f) ; rr
cc_ll <- function(df){
res <- c(0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
#browser()
r <- round(sum(f[f$confidence.U.== ll[i],21]),2)
l <- round(as.numeric(ll[i]),3)
res <- rbind(res,c(l,r))
}
return(res)
}
rr <- cc_ll(f) ; rr
cc_ll <- function(df){
res <- c(0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
#browser()
r <- round(sum(f[f$confidence.U.== ll[i],21]),2)
l <- round(as.numeric(ll[i]),3)
res <- rbind(res,c(l,r))
}
res <- res[-1,]
return(res)
}
rr <- cc_ll(f) ; rr
cc_ll <- function(df){
res <- c(0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
browser()
r <- round(sum(f[f$confidence.U.== ll[i],21]),2)
ct <- length(f[f$confidence.U.== ll[i])
l <- round(as.numeric(ll[i]),3)
res <- rbind(res,c(l,r))
}
res <- res[-1,]
return(res)
}
rr <- cc_ll(f) ; rr
cc_ll <- function(df){
res <- c(0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
browser()
r <- round(sum(f[f$confidence.U.== ll[i],21]),2)
ct <- nrow(f[f$confidence.U.== ll[i],)
l <- round(as.numeric(ll[i]),3)
res <- rbind(res,c(l,r))
}
res <- res[-1,]
return(res)
}
cc_ll <- function(df){
res <- c(0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
browser()
r <- round(sum(f[f$confidence.U.== ll[i],21]),2)
ct <- nrow(f[f$confidence.U.== ll[i],)
l <- round(as.numeric(ll[i]),3)
res <- rbind(res,c(l,r))
}
res <- res[-1,]
return(res)
}
rr <- cc_ll(f) ; rr
cc_ll <- function(df){
res <- c(0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
browser()
r <- round(sum(f[f$confidence.U.== ll[i],21]),2)
ct <- nrow(f[f$confidence.U.== ll[i],)
l <- round(as.numeric(ll[i]),3)
res <- rbind(res,c(l,r))
}
res <- res[-1,]
return(res)
}
cc_ll <- function(df){
res <- c(0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
browser()
r <- round(sum(f[f$confidence.U.== ll[i],21]),2)
ct <- length(f[f$confidence.U.== ll[i],)
l <- round(as.numeric(ll[i]),3)
res <- rbind(res,c(l,r))
}
res <- res[-1,]
return(res)
}
cc_ll <- function(df){
res <- c(0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
browser()
r <- round(sum(df[f$confidence.U.== ll[i],21]),2)
ct <- length(df[df$confidence.U.== ll[i],)
l <- round(as.numeric(ll[i]),3)
res <- rbind(res,c(l,r))
}
res <- res[-1,]
return(res)
}
cc_ll <- function(df){
res <- c(0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
browser()
r <- round(sum(df[f$confidence.U.== ll[i],21]),2)
#ct <- length(df[df$confidence.U.== ll[i],)
l <- round(as.numeric(ll[i]),3)
res <- rbind(res,c(l,r))
}
res <- res[-1,]
return(res)
}
cc_ll <- function(df){
res <- c(0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
browser()
df2 <- df[f$confidence.U.== ll[i],]
#r <- round(sum(df[f$confidence.U.== ll[i],21]),2)
r <- round(sum(df2[df2$confidence.U.== ll[i],21]),2)
ct <- nrow(df2)
l <- round(as.numeric(ll[i]),3)
res <- rbind(res,c(l,r))
}
res <- res[-1,]
return(res)
}
rr <- cc_ll(f) ; rr
r
ct
cc_ll <- function(df){
res <- c(0,0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
#browser()
df2 <- df[f$confidence.U.== ll[i],]
#r <- round(sum(df[f$confidence.U.== ll[i],21]),2)
r <- round(sum(df2[df2$confidence.U.== ll[i],21]),2)
ct <- nrow(df2)
l <- round(as.numeric(ll[i]),3)
res <- rbind(res,c(l,r,ct))
}
res <- res[-1,]
return(res)
}
rr <- cc_ll(f) ; rr
cc_ll <- function(df){
res <- c(0,0,0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
#browser()
df2 <- df[f$confidence.U.== ll[i],]
#r <- round(sum(df[f$confidence.U.== ll[i],21]),2)
r <- round(sum(df2[df2$confidence.U.== ll[i],21]),2)
ct <- nrow(df2)
av <- r / ct
l <- round(as.numeric(ll[i]),3)
res <- rbind(res,c(l,r,ct,av))
}
res <- res[-1,]
return(res)
}
rr <- cc_ll(f) ; rr
cc_ll <- function(df){
res <- c(0,0,0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
#browser()
df2 <- df[f$confidence.U.== ll[i],]
#r <- round(sum(df[f$confidence.U.== ll[i],21]),2)
r <- round(sum(df2[df2$confidence.U.== ll[i],21]),2)
ct <- nrow(df2)
av <- round(r / ct,2)
l <- round(as.numeric(ll[i]),3)
res <- rbind(res,c(l,r,ct,av))
}
res <- res[-1,]
return(res)
}
rr <- cc_ll(f) ; rr
cc_ll <- function(df){
res <- c(0,0,0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
#browser()
df2 <- df[f$confidence.U.== ll[i],]
#r <- round(sum(df[f$confidence.U.== ll[i],21]),2)
r <- round(sum(df2[df2$confidence.U.== ll[i],21]),2)
ct <- nrow(df2)
av <- round(r / ct,2)
l <- round(as.numeric(ll[i]),3)
res <- rbind(res,c(l,r,ct,av))
}
res <- res[-1,]
colnames(res) <- c('Conf','pl','#','av')
return(res)
}
rr <- cc_ll(f) ; rr
cc_ll <- function(df){
res <- c(0,0,0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
#browser()
df2 <- df[f$confidence.U.== ll[i],]
#r <- round(sum(df[f$confidence.U.== ll[i],21]),2)
r <- round(sum(df2[df2$confidence.U.== ll[i],21]),2)
ct <- nrow(df2)
av <- round(r / ct,2)
l <- round(as.numeric(ll[i]),3)
res <- rbind(res,c(l,r,ct,av))
}
res <- res[-1,]
colnames(res) <- c('Conf','pl','Trades','av')
return(res)
}
rr <- cc_ll(f) ; rr
cc_ll <- function(df){
res <- c(0,0,0,0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
#browser()
df2 <- df[f$confidence.U.== ll[i],]
#r <- round(sum(df[f$confidence.U.== ll[i],21]),2)
r <- round(sum(df2[df2$confidence.U.== ll[i],21]),2)
ct <- nrow(df2)
win <- length(df2$pl > 0)
av <- round(r / ct,2)
l <- round(as.numeric(ll[i]),3)
res <- rbind(res,c(l,r,ct,av,win))
}
res <- res[-1,]
colnames(res) <- c('Conf','pl','Trades','av','wins')
return(res)
}
rr <- cc_ll(f) ; rr
cc_ll <- function(df){
res <- c(0,0,0,0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
#browser()
df2 <- df[f$confidence.U.== ll[i],]
#r <- round(sum(df[f$confidence.U.== ll[i],21]),2)
r <- round(sum(df2[df2$confidence.U.== ll[i],21]),2)
ct <- nrow(df2)
win <- sum(df2$pl > 0)
av <- round(r / ct,2)
l <- round(as.numeric(ll[i]),3)
res <- rbind(res,c(l,r,ct,av,win))
}
res <- res[-1,]
colnames(res) <- c('Conf','pl','Trades','av','wins')
return(res)
}
rr <- cc_ll(f) ; rr
cc_ll <- function(df){
res <- c(0,0,0,0,0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
#browser()
df2 <- df[f$confidence.U.== ll[i],]
#r <- round(sum(df[f$confidence.U.== ll[i],21]),2)
r <- round(sum(df2[df2$confidence.U.== ll[i],21]),2)
ct <- nrow(df2)
win <- sum(df2$pl > 0)
win_per <- round(win/ct,2)
av <- round(r / ct,2)
l <- round(as.numeric(ll[i]),3)
res <- rbind(res,c(l,r,ct,av,win))
}
res <- res[-1,]
colnames(res) <- c('Conf','pl','Trades','av','wins','win %')
return(res)
}
rr <- cc_ll(f) ; rr
cc_ll <- function(df){
res <- c(0,0,0,0,0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
#browser()
df2 <- df[f$confidence.U.== ll[i],]
#r <- round(sum(df[f$confidence.U.== ll[i],21]),2)
r <- round(sum(df2[df2$confidence.U.== ll[i],21]),2)
ct <- nrow(df2)
win <- sum(df2$pl > 0)
win_per <- round(win/ct,2)
av <- round(r / ct,2)
l <- round(as.numeric(ll[i]),3)
res <- rbind(res,c(l,r,ct,av,win,win_per))
}
res <- res[-1,]
colnames(res) <- c('Conf','pl','Trades','av','wins','win %')
return(res)
}
rr <- cc_ll(f) ; rr
cc_ll <- function(df){
res <- c(0,0,0,0,0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
#browser()
df2 <- df[f$confidence.U.== ll[i],]
#r <- round(sum(df[f$confidence.U.== ll[i],21]),2)
r <- round(sum(df2[df2$confidence.U.== ll[i],21]),2)
ct <- nrow(df2)
win <- sum(df2$pl > 0)
win_per <- round(win/ct,2)
av <- round(r / ct,2) * 100
l <- round(as.numeric(ll[i]),3)
res <- rbind(res,c(l,r,ct,av,win,win_per))
}
res <- res[-1,]
colnames(res) <- c('Conf','pl','Trades','av','wins','win %')
return(res)
}
rr <- cc_ll(f) ; rr
cc_ll <- function(df){
res <- c(0,0,0,0,0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
#browser()
df2 <- df[f$confidence.U.== ll[i],]
#r <- round(sum(df[f$confidence.U.== ll[i],21]),2)
r <- round(sum(df2[df2$confidence.U.== ll[i],21]),2)
ct <- nrow(df2)
win <- sum(df2$pl > 0)
win_per <- round(win/ct,2)
av <- round(r / ct,2) * 100
l <- round(as.numeric(ll[i]),3)
res <- rbind(res,c(l,r,ct,av,win,win_per))
}
res <- res[-1,]
colnames(res) <- c('Conf','pl','Trades','av','wins','win %')
return(res)
}
rr <- cc_ll(f) ; rr
cc_ll <- function(df){
res <- c(0,0,0,0,0,0)
ll <- levels(f$confidence.U.)
for(i in 1:length(ll)){
#browser()
df2 <- df[f$confidence.U.== ll[i],]
#r <- round(sum(df[f$confidence.U.== ll[i],21]),2)
r <- round(sum(df2[df2$confidence.U.== ll[i],21]),2)
ct <- nrow(df2)
win <- sum(df2$pl > 0)
win_per <- round(win/ct,2) * 100
av <- round(r / ct,2)
l <- round(as.numeric(ll[i]),3)
res <- rbind(res,c(l,r,ct,av,win,win_per))
}
res <- res[-1,]
colnames(res) <- c('Conf','pl','Trades','av','wins','win %')
return(res)
}
rr <- cc_ll(f) ; rr
f <- read.csv('as_arima_dax_res.csv',stringsAsFactors=T)
f$pl <- ifelse(f$pred=='U',f$Close-f$Open,f$Open-f$Close)
rr <- cc_ll(f) ; rr
f <- read.csv('as_arima_cac_res.csv',stringsAsFactors=T)
f$pl <- ifelse(f$pred=='U',f$Close-f$Open,f$Open-f$Close)
rr <- cc_ll(f) ; rr
f <- read.csv('as_arima_ftse_res.csv',stringsAsFactors=T)
f$pl <- ifelse(f$pred=='U',f$Close-f$Open,f$Open-f$Close)
rr <- cc_ll(f) ; rr
f <- read.csv('as_arima_nik_res.csv',stringsAsFactors=T)
f$pl <- ifelse(f$pred=='U',f$Close-f$Open,f$Open-f$Close)
rr <- cc_ll(f) ; rr
f <- read.csv('as_arima_oz_res.csv',stringsAsFactors=T)
f$pl <- ifelse(f$pred=='U',f$Close-f$Open,f$Open-f$Close)
rr <- cc_ll(f) ; rr
setwd("D:/Allan/DropBox/Dmin")
source("DMin_fnc.R")
library(TTR)
indata <- read.table("clipboard")
colnames(indata) <- c('Mkt','Date','Open','High','Low','Close')
tail(indata)
Dax <- read.csv("Dax_2000.csv")
tail(Dax)
ln <- nrow(Dax)
Dax <- Dax[-ln,]
Dax_2 <- add_line(indata,1,Dax)
tail(Dax_2)
Dax <- read.csv("Dax_2000.csv")
tail(Dax)
ln <- nrow(Dax)
Dax <- Dax[-ln,]
tail(Dax)
Dax_2 <- add_line(indata,1,Dax)
tail(Dax_2)
indata <- read.table("clipboard")
colnames(indata) <- c('Mkt','Date','Open','High','Low','Close')
tail(indata)
Dax <- read.csv("Dax_2000.csv")
tail(Dax)
ln <- nrow(Dax)
Dax <- Dax[-ln,]
Dax_2 <- add_line(indata,1,Dax)
tail(Dax_2)
write.csv(Dax_2,"Dax_2000.csv",row.names=FALSE)
Dax_2 <- add_line(indata,6,Dax_2)
tail(Dax_2)
write.csv(Dax_2,"Dax_2000.csv",row.names=FALSE)
CAC <- read.csv("CAC_2000.csv")
tail(CAC)
ln <- nrow(CAC)
CAC <- CAC[-ln,]
CAC_2 <- add_line(indata,2,CAC)
tail(CAC_2)
write.csv(CAC_2,"CAC_2000.csv",row.names=FALSE)
#add dummy entry, tomoorw
CAC_2 <- add_line(indata,6,CAC_2)
tail(CAC_2)
write.csv(CAC_2,"CAC_2000.csv",row.names=FALSE)
F100 <- read.csv("F100_2000.csv")
tail(F100)
ln <- nrow(F100)
F100 <- F100[-ln,]
F100_2 <- add_line(indata,3,F100)
tail(F100_2)
write.csv(F100_2,"F100_2000.csv",row.names=FALSE)
F100_2 <- add_line(indata,6,F100_2)
tail(F100_2)
write.csv(F100_2,"F100_2000.csv",row.names=FALSE)
Nik <- read.csv("N225_2000.csv")
tail(Nik)
ln <- nrow(Nik)
Nik <- Nik[-ln,]
Nik_2 <- add_line(indata,4,Nik) #4th line fr Nikkei
tail(Nik_2)
write.csv(Nik_2,"N225_2000.csv",row.names=FALSE)
Nik_2 <- add_line(indata,6,Nik)
tail(Nik_2)
write.csv(Nik_2,"N225_2000.csv",row.names=FALSE)
Oz <- read.csv("Oz_2000.csv")
tail(Oz)
ln <- nrow(Oz)
Oz <- Oz[-ln,]
Oz_2 <- add_line(indata,5,Oz) #4th line fr Nikkei
tail(Oz_2)
write.csv(Oz_2,"Oz_2000.csv",row.names=FALSE)
Oz_2 <- add_line(indata,6,Oz_2)
tail(Oz_2)
write.csv(Oz_2,"Oz_2000.csv",row.names=FALSE)
