library(TTR)
indata <- read.table("clipboard")
colnames(indata) <- c('Mkt','Date','Open','High','Low','Close')
tail(indata)
Dax <- read.csv("Dax_2000.csv")
tail(Dax)
ln <- nrow(Dax)
Dax <- Dax[-ln,]
Dax_2 <- add_line(indata,1,Dax)
source("DMin_fnc.R")
library(TTR)
Dax_2 <- add_line(indata,1,Dax)
tail(Dax_2)
write.csv(Dax_2,"Dax_2000.csv",row.names=FALSE)
Dax_2 <- add_line(indata,6,Dax_2)
tail(Dax_2)
write.csv(Dax_2,"Dax_2000.csv",row.names=FALSE)
CAC <- read.csv("CAC_2000.csv")
tail(CAC)
ln <- nrow(CAC)
CAC <- CAC[-ln,]
CAC_2 <- add_line(indata,2,CAC)
tail(CAC_2)
write.csv(CAC_2,"CAC_2000.csv",row.names=FALSE)
CAC_2 <- add_line(indata,6,CAC_2)
tail(CAC_2)
write.csv(CAC_2,"CAC_2000.csv",row.names=FALSE)
F100 <- read.csv("F100_2000.csv")
tail(F100)
ln <- nrow(F100)
F100 <- F100[-ln,]
F100_2 <- add_line(indata,3,F100)
tail(F100_2)
write.csv(F100_2,"F100_2000.csv",row.names=FALSE)
F100_2 <- add_line(indata,6,F100_2)
tail(F100_2)
write.csv(F100_2,"F100_2000.csv",row.names=FALSE)
indata <- read.table("clipboard")
colnames(indata) <- c('Mkt','Date','Open','High','Low','Close')
tail(indata)
Nik <- read.csv("N225_2000.csv")
tail(Nik)
ln <- nrow(Nik)
Nik <- Nik[-ln,]
Nik_2 <- add_line(indata,4,Nik) #4th line fr Nikkei
tail(Nik_2)
Oz <- read.csv("Oz_2000.csv")
tail(Oz)
ln <- nrow(Oz)
Oz <- Oz[-ln,]
Oz_2 <- add_line(indata,5,Oz) #4th line fr Nikkei
tail(Oz_2)
write.csv(Oz_2,"Oz_2000.csv",row.names=FALSE)
Oz_2 <- add_line(indata,6,Oz_2)
tail(Oz_2)
write.csv(Oz_2,"Oz_2000.csv",row.names=FALSE)
Nik <- read.csv("N225_2000.csv")
tail(Nik)
Nik <- read.csv("N225_2000.csv")
tail(Nik)
ln <- nrow(Nik)
Nik <- Nik[-ln,]
Nik_2 <- add_line(indata,4,Nik) #4th line fr Nikkei
tail(Nik_2)
write.csv(Nik_2,"N225_2000.csv",row.names=FALSE)
Nik_2 <- add_line(indata,6,Nik)
tail(Nik_2)
Nik <- read.csv("N225_2000.csv")
tail(Nik)
Nik_2 <- add_line(indata,6,Nik)
tail(Nik_2)
write.csv(Nik_2,"N225_2000.csv",row.names=FALSE)
library(forecast)
exp_sm <- function(Mkt_ts, Mkt, st){
browser()
Mkta <- Mkt
cc <- Mkta[1,]
cc$a <- 0
ln <- nrow(Mkt)
lb <- 300 #lookback
for(i in 301:ed){
st <- i-300
Mkt_slice <- window(Mkt_ts,start=st,end=i)
mod <- ets(Mkt_slice, model="AAN")
fcast <- forecast.ets(mod)
a <- fcast$fitted[300]
a <- mod
b <- Mkta[i,]
ab <- cbind(b,a)
cc <- rbind(cc,ab)
}
cc <- cc[-1,]
return(cc)
}
Mkt <- read.csv("../Data/Dax_2000_d.csv")
setwd("D:/Allan/DropBox/MSc/Dissertation/Thesis/RCode")
Mkt <- read.csv("../Data/Dax_2000_d.csv")
tail(Mkt)
Mkt_ts <- ts(Mkt$Close)
mod <- ets(Mkt_ts)
mod$method
exp_sm <- function(Mkt_ts, Mkt, st){
browser()
Mkta <- Mkt
cc <- Mkta[1,]
cc$a <- 0
ln <- nrow(Mkt)
lb <- 300 #lookback
for(i in 301:ln){
st <- i-300
Mkt_slice <- window(Mkt_ts,start=st,end=i)
mod <- ets(Mkt_slice, model="AAN")
#fcast <- forecast.ets(mod)
#a <- fcast$fitted[300]
a <- mod$method
b <- Mkta[i,]
ab <- cbind(b,a)
cc <- rbind(cc,ab)
}
cc <- cc[-1,]
return(cc)
}
exp_sm(exp_sm, Mkt, 3000)
i
exp_sm <- function(Mkt_ts, Mkt, st){
browser()
Mkta <- Mkt
cc <- Mkta[1,]
cc$a <- 0
ln <- nrow(Mkt)
lb <- 300 #lookback
for(i in 301:ln){
st <- i-300
Mkt_slice <- window(Mkt_ts,start=st,end=i)
mod <- ets(Mkt_slice)
#fcast <- forecast.ets(mod)
#a <- fcast$fitted[300]
a <- mod$method
b <- Mkta[i,]
ab <- cbind(b,a)
cc <- rbind(cc,ab)
}
cc <- cc[-1,]
return(cc)
}
exp_sm(exp_sm, Mkt, 3000)
exp_sm(exp_sm, Mkt, 3000)
i
st
Mkt <- read.csv("../Data/Dax_2000_d.csv")
tail(Mkt)
Mkt_ts <- ts(Mkt$Close)
exp_sm <- function(Mkt_ts, Mkt, st){
browser()
Mkta <- Mkt
cc <- Mkta[1,]
cc$a <- 0
ln <- nrow(Mkt)
lb <- 300 #lookback
for(i in 301:ln){
st <- i-300
Mkt_slice <- window(Mkt_ts,start=st,end=i)
modf <- ets(Mkt_slice)
#fcast <- forecast.ets(mod)
#a <- fcast$fitted[300]
a <- modf$method
b <- Mkta[i,]
ab <- cbind(b,a)
cc <- rbind(cc,ab)
}
cc <- cc[-1,]
return(cc)
}
exp_sm <- function(Mkt_ts, Mkt, strt){
browser()
Mkta <- Mkt
cc <- Mkta[1,]
cc$a <- 0
ln <- nrow(Mkt)
lb <- 300 #lookback
for(i in strt:ln){
st <- i-300
Mkt_slice <- window(Mkt_ts,start=st,end=i)
modf <- ets(Mkt_slice)
#fcast <- forecast.ets(mod)
#a <- fcast$fitted[300]
a <- modf$method
b <- Mkta[i,]
ab <- cbind(b,a)
cc <- rbind(cc,ab)
}
cc <- cc[-1,]
return(cc)
}
exp_sm(exp_sm, Mkt, 3000)
st
Mkt_ts <- ts(Mkt$Close)
Mkt_train <- window(Mkt_ts, start=2000, end=2030)
setwd("D:/Allan/DropBox/MSc/Dissertation/Thesis/RCode")
Mkt <- read.csv("../Data/Dax_2000_d.csv")
tail(Mkt)
Mkt_ts <- ts(Mkt$Close)
exp_sm2 <- function(Mkt, Mkt_ts, st){
browser()
Mkta <- Mkt
cc <- Mkta[1,]
cc$a <- 0
ln <- nrow(Mkt)
lb <- 300 #lookback
for(i in 301:ln){
st <- i-300
#Mkt_slice <- window(Mkt_ts,start=st,end=i)
Mkt_slice <- window(Mkt_ts,start=st,end=i)
mod <- ets(Mkt_slice)
a <- mod$method
#fcast <- forecast.ets(mod)
#a <- fcast$fitted[300]
b <- Mkta[i,]
ab <- cbind(b,a)
cc <- rbind(cc,ab)
}
#cc <- cc[-1,]
return(cc)
}
exp_sm2(Mkt,Mkt_ts,2000)
exp_sm(Mkt,Mkt_ts, 3000)
exp_sm(Mkt,Mkt_ts, 3000)
exp_sm(Mkt_ts,Mkt, 3000)
cc
cc
exp_sm <- function(Mkt_ts, Mkt, strt){
#browser()
Mkta <- Mkt
cc <- Mkta[1,]
cc$a <- 0
ln <- nrow(Mkt)
lb <- 300 #lookback
for(i in strt:ln){
st <- i-300
Mkt_slice <- window(Mkt_ts,start=st,end=i)
modf <- ets(Mkt_slice)
#fcast <- forecast.ets(mod)
#a <- fcast$fitted[300]
a <- modf$method
b <- Mkta[i,]
ab <- cbind(b,a)
cc <- rbind(cc,ab)
}
cc <- cc[-1,]
return(cc)
}
as <- exp_sm(Mkt_ts,Mkt, 3000)
as
exp_sm <- function(Mkt_ts, Mkt, strt){
#browser()
Mkta <- Mkt
cc <- Mkta[1,]
cc$a <- 0
ln <- nrow(Mkt)
#lb <- 300 #lookback
for(i in strt:ln){
st <- i-30
Mkt_slice <- window(Mkt_ts,start=st,end=i)
modf <- ets(Mkt_slice)
#fcast <- forecast.ets(mod)
#a <- fcast$fitted[300]
a <- modf$method
b <- Mkta[i,]
ab <- cbind(b,a)
cc <- rbind(cc,ab)
}
cc <- cc[-1,]
return(cc)
}
Mkt_ar <- read.csv("../Data/Dax_2000_d.csv")
ar <- aroon(Mkt_ar[c(3,4)], n=20)
tail(ar)
ar <- aroon(Mkt_ar[c(5)], n=20)
tail(ar)
tail(ar,n=20)
Mkt_ar2 <- cbind(Mkt_ar,ar)
tail(Mkt_ar2,n=20)
tail(Mkt_ar2,n=20)
ar <- aroon(Mkt_ar[c(5)], n=10)
Mkt_ar2 <- cbind(Mkt_ar,ar)
tail(Mkt_ar2,n=20)
ar <- aroon(Mkt_ar[c(5)], n=20)
Mkt_ar2 <- cbind(Mkt_ar,ar)
tail(Mkt_ar2,n=20)
nrow(Mkt_ar2)
Mkt_ar2[Mkt_ar2$aroonUp > 0.65,]
aup <- Mkt_ar2[Mkt_ar2$aroonUp > 0.65,]
nrow(aup)
adn <- Mkt_ar2[Mkt_ar2$aroonDn > 0.65,]
nrow(adn)
aup <- Mkt_ar2[Mkt_ar2$aroonUp > 0.65 & Mkt_ar2$aroonDn < 0.35,]
nrow(aup)
adn <- Mkt_ar2[Mkt_ar2$aroonDn > 0.65 & Mkt_ar2$aroonUp < 0.35,]
nrow(adn)
aup <- Mkt_ar2[Mkt_ar2$aroonUp > 0.65 & Mkt_ar2$aroonDn < 0.4,]
nrow(aup)
nrow(adn)
indata <- read.table("clipboard")
colnames(indata) <- c('Mkt','Date','Open','High','Low','Close')
tail(indata)
Dax <- read.csv("Dax_2000.csv")
tail(Dax)
setwd("D:/Allan/DropBox/Dmin")
source("DMin_fnc.R")
library(TTR)
Dax <- read.csv("Dax_2000.csv")
tail(Dax)
ln <- nrow(Dax)
Dax <- Dax[-ln,]
Dax_2 <- add_line(indata,1,Dax)
tail(Dax_2)
write.csv(Dax_2,"Dax_2000.csv",row.names=FALSE)
Dax_2 <- add_line(indata,6,Dax_2)
tail(Dax_2)
write.csv(Dax_2,"Dax_2000.csv",row.names=FALSE)
tail(Dax)
Dax <- read.csv("Dax_2000.csv")
tail(Dax)
CAC <- read.csv("CAC_2000.csv")
tail(CAC)
ln <- nrow(CAC)
CAC <- CAC[-ln,]
CAC_2 <- add_line(indata,2,CAC)
tail(CAC_2)
write.csv(CAC_2,"CAC_2000.csv",row.names=FALSE)
CAC_2 <- add_line(indata,6,CAC_2)
tail(CAC_2)
indata <- read.table("clipboard")
colnames(indata) <- c('Mkt','Date','Open','High','Low','Close')
tail(indata)
CAC_2 <- add_line(indata,6,CAC_2)
tail(CAC_2)
CAC <- read.csv("CAC_2000.csv")
tail(CAC)
CAC_2 <- add_line(indata,6,CAC)
tail(CAC_2)
write.csv(CAC_2,"CAC_2000.csv",row.names=FALSE)
F100 <- read.csv("F100_2000.csv")
tail(F100)
ln <- nrow(F100)
F100 <- F100[-ln,]
F100_2 <- add_line(indata,3,F100)
tail(F100_2)
write.csv(F100_2,"F100_2000.csv",row.names=FALSE)
F100_2 <- add_line(indata,6,F100_2)
tail(F100_2)
write.csv(F100_2,"F100_2000.csv",row.names=FALSE)
Nik <- read.csv("N225_2000.csv")
tail(Nik)
ln <- nrow(Nik)
Nik <- Nik[-ln,]
Nik_2 <- add_line(indata,4,Nik) #4th line fr Nikkei
tail(Nik_2)
write.csv(Nik_2,"N225_2000.csv",row.names=FALSE)
Nik_2 <- add_line(indata,6,Nik_2)
tail(Nik_2)
write.csv(Nik_2,"N225_2000.csv",row.names=FALSE)
Oz <- read.csv("Oz_2000.csv")
tail(Oz)
ln <- nrow(Oz)
Oz <- Oz[-ln,]
Oz_2 <- add_line(indata,5,Oz) #4th line fr Nikkei
tail(Oz_2)
write.csv(Oz_2,"Oz_2000.csv",row.names=FALSE)
#add dummy entry, tomoorw
Oz_2 <- add_line(indata,6,Oz_2)
tail(Oz_2)
write.csv(Oz_2,"Oz_2000.csv",row.names=FALSE)
fil <- c("../Data/Dax_2000_d.csv",
"../Data/CAC_2000_d.csv",
"../Data/F100_2000_d.csv",
"../Data/Dow_2000_d.csv",
"../Data/N225_2000_d.csv",
"../Data/Oz_2000.csv")
nm <- c("Dax", "CAC", "F100", "Dow", "Nik", "Oz")
df10 <- as.data.frame(matrix(seq(11),nrow=1,ncol=11))
minor_HL <- function(fil, nm){
df <- t(c('a','b'))
#browser()
for(i in 1:length(fil)){
Mkt <- read.csv(fil[i])
ln <- nrow(Mkt)
st <- ln - 50
Mkt <- Mkt[st:ln,]
Mkt$OL <- Mkt$Open - Mkt$Low
Mkt$OH <- Mkt$Low -  Mkt$Open
Mkt$mn <- ifelse(Mkt$OH>Mkt$OL,Mkt$OL,Mkt$OH)
a <- quantile(Mkt$mn, probs=0.90)
b <- nm[i]
df <- rbind(df,t(c(a,b)))
}
colnames(df) <- c('Mkt', 'Minor Move')
df <- df[-1,]
}
res <- minor_HL(fil, nm)
setwd("D:/Allan/DropBox/Dmin")
fil <- c("Dax_2000.csv",
"CAC_2000.csv",
"F100_2000.csv",
"Dow_2000.csv",
"N225_2000.csv",
"Oz_2000.csv")
nm <- c("Dax", "CAC", "F100", "Dow", "Nik", "Oz")
df10 <- as.data.frame(matrix(seq(11),nrow=1,ncol=11))
minor_HL <- function(fil, nm){
df <- t(c('a','b'))
#browser()
for(i in 1:length(fil)){
Mkt <- read.csv(fil[i])
ln <- nrow(Mkt)
st <- ln - 50
Mkt <- Mkt[st:ln,]
Mkt$OL <- Mkt$Open - Mkt$Low
Mkt$OH <- Mkt$Low -  Mkt$Open
Mkt$mn <- ifelse(Mkt$OH>Mkt$OL,Mkt$OL,Mkt$OH)
a <- quantile(Mkt$mn, probs=0.90)
b <- nm[i]
df <- rbind(df,t(c(a,b)))
}
colnames(df) <- c('Mkt', 'Minor Move')
df <- df[-1,]
}
res <- minor_HL(fil, nm)
res
minor_HL <- function(fil, nm){
df <- t(c('a','b'))
browser()
for(i in 1:length(fil)){
Mkt <- read.csv(fil[i])
ln <- nrow(Mkt)
st <- ln - 50
Mkt <- Mkt[st:ln,]
Mkt$OL <- Mkt$Open - Mkt$Low
Mkt$OH <- Mkt$Low -  Mkt$Open
Mkt$mn <- ifelse(Mkt$OH>Mkt$OL,Mkt$OL,Mkt$OH)
a <- quantile(Mkt$mn, probs=0.90)
b <- nm[i]
df <- rbind(df,t(c(a,b)))
}
colnames(df) <- c('Minor Move', 'Mkt')
df <- df[-1,]
}
res <- minor_HL(fil, nm)
ln
st
nrow(Mkt)
tail(Mkt)
Mkt$OL
Mkt$mn
minor_HL <- function(fil, nm){
df <- t(c('a','b'))
browser()
for(i in 1:length(fil)){
Mkt <- read.csv(fil[i])
ln <- nrow(Mkt)
st <- ln - 50
Mkt <- Mkt[st:ln,]
Mkt$OL <- Mkt$Open - Mkt$Low
Mkt$OH <- Mkt$High -  Mkt$Open
Mkt$mn <- ifelse(Mkt$OH>Mkt$OL,Mkt$OL,Mkt$OH)
a <- quantile(Mkt$mn, probs=0.90)
b <- nm[i]
df <- rbind(df,t(c(a,b)))
}
colnames(df) <- c('Minor Move', 'Mkt')
df <- df[-1,]
}
minor_HL <- function(fil, nm){
df <- t(c('a','b'))
#browser()
for(i in 1:length(fil)){
Mkt <- read.csv(fil[i])
ln <- nrow(Mkt)
st <- ln - 50
Mkt <- Mkt[st:ln,]
Mkt$OL <- Mkt$Open - Mkt$Low
Mkt$OH <- Mkt$High -  Mkt$Open
Mkt$mn <- ifelse(Mkt$OH>Mkt$OL,Mkt$OL,Mkt$OH)
a <- quantile(Mkt$mn, probs=0.90)
b <- nm[i]
df <- rbind(df,t(c(a,b)))
}
colnames(df) <- c('Minor Move', 'Mkt')
df <- df[-1,]
}
res <- minor_HL(fil, nm)
res
minor_HL <- function(fil, nm){
df <- t(c('a','b'))
#browser()
for(i in 1:length(fil)){
Mkt <- read.csv(fil[i])
ln <- nrow(Mkt)
st <- ln - 50
Mkt <- Mkt[st:ln,]
Mkt$OL <- Mkt$Open - Mkt$Low
Mkt$OH <- Mkt$High -  Mkt$Open
Mkt$mn <- ifelse(Mkt$OH>Mkt$OL,Mkt$OL,Mkt$OH)
a <- round(quantile(Mkt$mn, probs=0.90),2)
b <- nm[i]
df <- rbind(df,t(c(a,b)))
}
colnames(df) <- c('Minor Move', 'Mkt')
df <- df[-1,]
}
res <- minor_HL(fil, nm)
res
